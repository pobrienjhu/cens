import numpy
import matplotlib.pyplot as plt
import networkx
from networkx.generators.community import *
import logging
import timeit
import time
import SimulationUtils
import Simulation
import ERGraphGenerator

logger = logging.getLogger('SimulationLogger')

dir = "Doctoral.Research/Exploration.vs.Exploitation - Structural Design/results/er-graph-realitychange-turnover"

# Set the log levels
logger.setLevel(logging.INFO)

# The number of dimensions of reality
# 30 is the number from the original March experiment
m = [100] #[40,70,100,130,160]

# number of individuals  in the organization
# 50 is the number from the original March experiment
n = [140] #[140,210,280,350,420]

#probability of edge creation
#B = [
#0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,
#0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,
#0.2,0.22,0.24,0.26,0.28,
#0.3,0.32,0.34,0.36,0.38,
#0.4,0.42,0.44,0.46,0.48,
#0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.95,1]

# for testing reality change / turnover
B = [0.09]

# degree of complexity
s = [5] #[1,3,5,7,10]

# effectiveness of learning
# The p values represent the probability of change
# p1 effectiveness of learning (socialization) 
pl = [0.3] #[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9]

#probability of turnover
pt = [0,0.01] #, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0]

#probability of change in each element of reality
pe = [0.1] #,0.4,0.7]

#interval of environmental change
T = 200

# number of times to run the simulations for each graph
iterations = 50

# number of different graphs to generate
graphsToRun = 10

recordEachRun = True
runToConvergeLimit = True

# Run the simulation for the er graph
for graphCount in range(0,graphsToRun): 
    timeStamp = time.time()    
    useDir = dir+"/run-"+str(timeStamp)            
    SimulationUtils.validateDir(useDir)       
    for bIndex, bValue in enumerate(B):             
        graphGenerator = ERGraphGenerator.ERGraphGenerator(bValue,timeStamp,useDir) 
        Simulation.simulation(m,n,s,pl,pt,pe,T,iterations,graphGenerator,useDir,recordEachRun,runToConvergeLimit)

